var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s;import{o as n,f as c,g as d,F as i,x as u,t as m,D as b,k as p,l as y,n as h,e as g,p as x,r as f,i as v,w as D,d as C,y as k,z as O}from"./vendor.b7297cc7.js";import{_ as E,b as w,a as T}from"./index.ed08c384.js";const L={props:["tableData","ROLE"]},M={class:"table-auto my-table"},N=d("thead",{class:"bg-rose-200"},[d("tr",null,[d("th",{class:"my-th"},"ID"),d("th",{class:"my-th"},"姓名"),d("th",{class:"my-th"},"角色"),d("th",{class:"my-th"},"貢獻值"),d("th",{class:"my-th"},"Email"),d("th",{class:"my-th"},"創建時間")])],-1),V={class:"my-tbody"},j={class:"my-td"},I={class:"my-td"},F={class:"my-td"},R={class:"my-td"},U={class:"my-td"},P={class:"my-td"};L.render=function(e,t,a,s,l,o){return n(),c("table",M,[N,d("tbody",V,[(n(!0),c(i,null,u(a.tableData,(({userId:e,name:t,role:s,contribution:l,email:o,createTime:r})=>(n(),c("tr",{key:e},[d("td",j,m(e),1),d("td",I,m(t),1),d("td",F,m(a.ROLE[s]),1),d("td",R,m(l),1),d("td",U,m(o),1),d("td",P,m(r),1)])))),128))])])};const S={},W={fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Y=d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z"},null,-1);S.render=function(e,t){return n(),c("svg",W,[Y])};const z={name:"CourseForm",components:{Dialog:b,DialogOverlay:p,DialogTitle:y,FolderPlusIcon:S,TextField:E,TextArea:w},props:{populateWith:{type:Object,default:()=>({courseName:"",deptName:"",category:"",description:""})}},setup(e,{emit:t}){const a=h(!1),s=h(null),l=g((()=>e.populateWith.courseId?"編輯":"新增課程")),o=x();return{btnText:l,isOpen:a,data:s,submit(){t("submit",s.value,(()=>{o.go(0)}),(e=>{console.log(e),alert(`${l}失敗了 QQ`)}))},closeModal(){a.value=!1},openModal(){s.value=Object.assign({},e.populateWith),a.value=!0}}}},H={class:"flex items-center"},$={class:"fixed inset-0 z-10 overflow-y-auto"},_={class:"min-h-screen px-4 text-center"},A=d("span",{class:"inline-block h-screen align-middle","aria-hidden":"true"}," ​ ",-1),Q={class:"dialog-container"},B={class:"mt-2"},q={class:"mt-4"};z.render=function(e,t,a,s,l,o){const r=f("FolderPlusIcon"),i=f("DialogOverlay"),u=f("DialogTitle"),b=f("text-field"),p=f("text-area"),y=f("Dialog");return n(),c("div",null,["新增課程"===s.btnText?(n(),c("button",{key:0,type:"button",onClick:t[1]||(t[1]=(...e)=>s.openModal&&s.openModal(...e)),class:"py-2 btn-add"},[d("div",H,[d(r,{class:"w-6 h-6 mr-0.5"}),v(" "+m(s.btnText),1)])])):(n(),c("button",{key:1,type:"button",onClick:t[2]||(t[2]=(...e)=>s.openModal&&s.openModal(...e)),class:"text-blue-900 text-base"},m(s.btnText),1)),d(y,{as:"div",open:s.isOpen,onClose:s.closeModal},{default:D((()=>[d("div",$,[d("div",_,[d(i,{class:"fixed inset-0 bg-gray-300 bg-opacity-50"}),A,d("div",Q,[d(u,{as:"h3",class:"text-lg text-gray-900"},{default:D((()=>[v(m(s.btnText),1)])),_:1}),d("div",B,[d(b,{modelValue:s.data.courseName,"onUpdate:modelValue":t[3]||(t[3]=e=>s.data.courseName=e),label:"課程名稱",class:"mt-2"},null,8,["modelValue"]),d(b,{modelValue:s.data.deptName,"onUpdate:modelValue":t[4]||(t[4]=e=>s.data.deptName=e),label:"所屬系所",class:"mt-2"},null,8,["modelValue"]),d(b,{modelValue:s.data.category,"onUpdate:modelValue":t[5]||(t[5]=e=>s.data.category=e),label:"所屬分類",class:"mt-2"},null,8,["modelValue"]),d(p,{modelValue:s.data.description,"onUpdate:modelValue":t[6]||(t[6]=e=>s.data.description=e),label:"詳細資訊",class:"mt-2"},null,8,["modelValue"])]),d("div",q,[d("button",{type:"button",class:"btn-submit",onClick:t[7]||(t[7]=(...e)=>s.submit&&s.submit(...e))}," 送出 "),d("button",{type:"button",class:"ml-8 text-sm text-rose-500",onClick:t[8]||(t[8]=(...e)=>s.closeModal&&s.closeModal(...e))}," 取消 ")])])])])])),_:1},8,["open","onClose"])])};const G={props:["tableData"],components:{CourseForm:z}},J={class:"table-fixed my-table"},K=d("thead",{class:"bg-rose-200"},[d("tr",null,[d("th",{class:"w-4 my-th"},"ID"),d("th",{class:"w-1/5 my-th"},"課程名稱"),d("th",{class:"w-16 my-th"},"所屬系所"),d("th",{class:"w-16 my-th"},"所屬分類"),d("th",{class:"w-4 my-th"},"考古題"),d("th",{class:"w-1/4 my-th"},"詳細資訊"),d("th",{class:"w-8 pl-3 md:pl-6 py-4"})])],-1),X={class:"my-tbody"},Z={class:"my-td"},ee={class:"my-td"},te={class:"my-td"},ae={class:"my-td"},se={class:"my-td"},le={class:"my-td"},oe={class:"block max-h-20 overflow-y-auto break-all"},re={class:"my-td"},ne={class:"flex flex-col items-center space-y-0.5"};G.render=function(e,t,a,s,l,o){const r=f("CourseForm");return n(),c("table",J,[K,d("tbody",X,[(n(!0),c(i,null,u(a.tableData,(({courseId:s,courseName:l,deptName:o,category:i,docNum:u,description:b},p)=>(n(),c("tr",{key:s},[d("td",Z,m(s),1),d("td",ee,m(l),1),d("td",te,m(o),1),d("td",ae,m(i),1),d("td",se,m(u),1),d("td",le,[d("div",oe,m(b),1)]),d("td",re,[d("div",ne,[d(r,{populateWith:a.tableData[p],onSubmit:t[1]||(t[1]=(...t)=>e.$emit("edit-course",...t))},null,8,["populateWith"]),d("button",{type:"button",class:"text-rose-900 text-base",onClick:t=>e.$emit("delete-course",s)}," 刪除 ",8,["onClick"])])])])))),128))])])};const ce=["ADMIN","EDITOR","USER"];var de=C({name:"Manage",components:{UserTable:L,CourseTable:G,CourseForm:z},setup(){const e=k({tableData:[],isLoading:!0,isError:!1}),n=k({tableData:[],isLoading:!0,isError:!1});T.Course.getList().then((t=>e.tableData=t.data)).catch((()=>e.isError=!0)).finally((()=>e.isLoading=!1)),T.Users.getList().then((e=>{n.tableData=e.data.map((e=>{return n=((e,t)=>{for(var a in t||(t={}))l.call(t,a)&&r(e,a,t[a]);if(s)for(var a of s(t))o.call(t,a)&&r(e,a,t[a]);return e})({},e),c={createTime:O(e.createTime).format("YYYY-MM-DD HH:mm")},t(n,a(c));var n,c}))})).catch((()=>n.isError=!0)).finally((()=>n.isLoading=!1));return{ROLE:ce,courses:e,users:n,createCourse:(e,t,a)=>{T.Course.create(e).then(t).catch(a)},editCourse:(e,t,a)=>{const{courseId:s,courseName:l,deptName:o,category:r,description:n}=e,c={courseName:l,deptName:o,category:r,description:n};T.Course.modify(s,c).then(t).catch(a)},deleteCourse:e=>{alert("Sorry~ 我們還沒做這個功能耶 > <")}}}});const ie={class:"my-6 px-10"},ue={class:"mb-4 flex"},me=d("h1",{class:"font-medium text-2xl text-gray-900"},"課程列表",-1),be=d("div",{class:"flex-1"},null,-1),pe={key:0},ye={key:1},he=d("h1",{class:"font-medium text-2xl text-gray-900 mb-4 mt-8"},"使用者列表",-1),ge={key:3},xe={key:4};de.render=function(e,t,a,s,l,o){const r=f("CourseForm"),i=f("CourseTable"),u=f("UserTable");return n(),c("div",ie,[d("div",ue,[me,be,d(r,{onSubmit:e.createCourse},null,8,["onSubmit"])]),e.courses.isLoading?(n(),c("p",pe,"Loading...")):e.courses.isError?(n(),c("p",ye,"error")):(n(),c(i,{key:2,tableData:e.courses.tableData,onEditCourse:e.editCourse,onDeleteCourse:e.deleteCourse},null,8,["tableData","onEditCourse","onDeleteCourse"])),he,e.users.isLoading?(n(),c("p",ge,"Loading...")):e.users.isError?(n(),c("p",xe,"error")):(n(),c(u,{key:5,tableData:e.users.tableData,ROLE:e.ROLE},null,8,["tableData","ROLE"]))])};export default de;
